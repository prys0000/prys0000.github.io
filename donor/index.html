<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HARC — Congregation Archival Resources</title>
  <meta name="description" content="Resources for congregations: collection policies, agreements, image/publication guidance, handling instructions, and the donor packet." />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Merriweather:wght@700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg: #F5F7F9;
      --card: #FFFFFF;
      --muted: #6B7280;
      --accent: #1c1b19;
      --accent-2: #205072;
      --radius: 10px;
      --container: 1100px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Merriweather;color:var(--accent);background:var(--bg);line-height:1.5}
    a{color:var(--accent);text-decoration:none}
    .wrap{max-width:var(--container);margin:0 auto;padding:18px}
    header{background:rgba(255,255,255,0.7);backdrop-filter:blur(4px);border-bottom:1px solid rgba(15,23,42,0.04);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo-link{display:inline-block;line-height:0}
    .logo-img{height:64px;width:auto;display:block}
    .logo-fallback{ width:64px;height:64px;border-radius:8px;background:linear-gradient(135deg,var(--accent-2),#c7b19d);color:#fff;display:inline-grid;place-items:center;font-weight:700;font-family:Merriweather }
    .button{background:var(--accent);color:#fff;padding:9px 14px;border-radius:8px;font-weight:600;border:0}

    .hero{padding:28px 0}
    .hero-grid{display:grid;grid-template-columns:1fr 320px;gap:24px;align-items:start}
    @media (max-width:880px){ .hero-grid{grid-template-columns:1fr} }

    h1{font-family:Merriweather,serif;font-size:26px;margin:0 0 8px}
    .lead{color:var(--muted);margin:0 0 14px}

    .card{background:var(--card);border-radius:var(--radius);padding:14px;box-shadow:0 6px 18px rgba(15,23,42,0.05)}
    .links-grid{display:grid;grid-template-columns:repeat(2,minmax(0,1fr));gap:12px;margin-top:12px}
    @media (max-width:880px){ .links-grid{grid-template-columns:1fr} }

    .link-item{padding:12px;border-radius:8px;border:1px solid rgba(15,23,42,0.04);background:linear-gradient(#fff,#fbfbfd);display:block}
    .link-item h4{margin:0 0 6px;font-size:18px}
    .link-item p{margin:0;color:var(--muted);font-size:13px}

    main{max-width:var(--container);margin:18px auto;padding:0 18px}
    .meta{color:var(--muted);font-size:14px}

    /* PDF viewer and file list */
    .pdf-wrap{margin-top:14px}
    .pdf-frame{width:100%;height:64vh;border:0;border-radius:8px;box-shadow:0 6px 18px rgba(15,23,42,0.04);display:none}
    .file-row{display:flex;justify-content:space-between;align-items:center;padding:10px;border-radius:8px;border:1px solid rgba(15,23,42,0.04);background:linear-gradient(#fff,#fbfbfd);gap:12px}
    .file-row .meta{color:var(--muted);font-size:13px}
    .btn{display:inline-block;padding:8px 12px;border-radius:8px;background:var(--accent);color:#fff;text-decoration:none;font-weight:600}

    .error-box{display:none;padding:14px;border-radius:8px;background:#fff;border:1px solid rgba(15,23,42,0.04);margin-top:10px}
    footer{padding:28px 18px;text-align:center;color:var(--muted);font-size:14px}

    /* Connect aside styles */
    aside.connect { display:block; background:linear-gradient(180deg,#fbfdff,#f6f9ff); padding:16px; border-radius:10px; border:1px solid #e7f1ff; box-shadow:0 8px 20px rgba(11,87,164,0.03); }
    aside.connect img.thumb { width:100%; border-radius:8px; object-fit:cover; margin-bottom:10px; display:block }
    aside.connect .muted { color:var(--accent-2); display:inline-block; margin:6px 0; text-decoration:underline; font-size:14px }
    .gallery-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(120px,1fr)); gap:8px; margin-top:12px }
    .gallery-grid img { width:100%; height:84px; object-fit:cover; border-radius:8px; border:1px solid rgba(15,23,42,0.04) }

    @media print{
      header,footer,aside{display:none}
      .pdf-frame{height:800px;display:block}
    }

    .sr-only { position: absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }

    /* Highlighted preview panel */
.preview-highlight {
  background: linear-gradient(180deg,#ffffff,#fbfdff);
  border-left: 6px solid var(--accent-2);
  padding: 18px;
  border-radius: 12px;
  box-shadow: 0 12px 30px rgba(32,80,114,0.06);
  margin-bottom: 18px;
  transition: transform .12s ease, box-shadow .12s ease;
}

.preview-highlight:focus-within,
.preview-highlight:hover {
  transform: translateY(-3px);
  box-shadow: 0 18px 40px rgba(32,80,114,0.09);
}

.preview-highlight .preview-header {
  display:flex;
  gap:12px;
  align-items:baseline;
  margin-bottom:12px;
}

.preview-highlight h3 {
  margin:0;
  font-size:20px;
  color: var(--accent-2);
  font-family: Merriweather, serif;
  font-weight:700;
}

.preview-badge {
  display:inline-block;
  background: var(--accent-2);
  color: #fff;
  font-weight:700;
  padding:6px 10px;
  border-radius:999px;
  font-size:13px;
  margin-left:8px;
}

.preview-help {
  color: var(--muted);
  font-size:13px;
  margin-left:auto;
}

/* slightly tighter layout for the file list inside the highlighted box */
.preview-highlight .file-row {
  background: transparent;
  border: 1px dashed rgba(15,23,42,0.03);
}

  </style>
</head>
<body>
  <header>
    <div class="wrap nav" role="banner">
      <div class="brand">
        <a class="logo-link" href="/donor/#handling" aria-label="Back to HARC home">
          <img src="/donor/harc-logo-2.jpg"
               alt="Heritage & Research Center at Saint Mary's"
               class="logo-img"
               onerror="this.style.display='none'; document.getElementById('logoFallback').style.display='inline-grid';" />
          <div id="logoFallback" class="logo-fallback" style="display:none" aria-hidden="true">H</div>
        </a>
        <div>
          <div style="font-weight:700">Heritage &amp; Research Center</div>
          <div style="font-size:13px;color:var(--muted)">Resources for Congregations &amp; Staff</div>
        </div>
      </div>

      <nav>
        <a class="button" href="/donor/harc-archives-toolkit.html" target="_blank" rel="noopener">Transition Toolkit</a>
        <a class="button" href="/donor/box-list.html" target="_blank" rel="noopener">Box List Inventory</a>
        <a class="button" href="/donor/item-level-inventory.html" target="_blank" rel="noopener">Item-level Inventory</a>
      </nav>
    </div>
  </header>

  <section class="hero">
    <div class="wrap hero-grid">
      <!-- main column -->
      <div>
        <h1>Welcome — Resources for Congregations &amp; Staff</h1>
        <p class="lead">A hub to review collection policies, intake/transfer agreements, image &amp; publication guidance, handling instructions, and the donor packet.</p>

        <div class="card" aria-labelledby="quicklinks">
          <div style="display:flex;justify-content:space-between;align-items:center">
            <div>
              <strong id="quicklinks" style="font-size:1.35rem;font-family:Merriweather;font-weight:900">Quick Links</strong>
              <div class="meta">Click any item below to preview or download the document.</div>
            </div>
            <div></div>
          </div>

          <div class="links-grid" style="margin-top:12px;display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:12px">
            <!-- TOP ITEM: HARC Transition Toolkit -->
            <a class="link-item" href="#harc-toolkit"
               data-src="/donor/harc-archives-toolkit.html"
               id="toolkit-link"
               onclick="previewAndScroll(event)"
               title="Preview HARC Transition Toolkit">
              <h4>HARC Transition Toolkit</h4>
              <p>Comprehensive guidance for assessing, planning, and executing archives transfers to HARC. Preview or open the full toolkit.</p>
            </a>

            <a class="link-item" href="#collection-agreement" data-src="/donor/harc-donor-congregation-agreement-draft2.pdf" onclick="previewAndScroll(event)">
              <h4>Collection Agreement</h4>
              <p>Collections Transfer Agreement (draft) — terms and next steps.</p>
            </a>

            <a class="link-item" href="#policies" data-src="/donor/harc-collection-policy-2025-draft1.pdf" onclick="previewAndScroll(event)">
              <h4>Collection Policies</h4>
              <p>Accessioning, access, retention, and restrictions.</p>
            </a>

            <a class="link-item" href="/donor/box-list.html" target="_blank" rel="noopener">
              <h4>Box-Level Inventories</h4>
              <p>Editable box-list template — one row per physical container.</p>
            </a>

            <a class="link-item" href="#image-use" data-src="/donor/harc-image-use-agreement-draft1.pdf" onclick="previewAndScroll(event)">
              <h4>Image &amp; Publication</h4>
              <p>Permissions, reproduction, and citation guidance.</p>
            </a>

            <a class="link-item" href="/donor/item-level-inventory.html" target="_blank" rel="noopener">
              <h4>Item-Level Inventories</h4>
              <p>Item-level finding aid template for photos, postcards, newsletters, and artifacts.</p>
            </a>
          </div>

          <!-- small gallery to preview the vault image(s) -->
          <div style="margin-top:14px">
            <h4 style="margin:0 0 8px 0">HARC — Inside the Vault</h4>
            <div class="gallery-grid" aria-hidden="false">
              <a href="/donor/vault-1.jpg" target="_blank" rel="noopener">
                <img src="/donor/vault-1.jpg" alt="HARC archival vault with shelving and boxes" onerror="this.replaceWith(createImageFallback())">
              </a>
              <!-- if you add more images, duplicate the <a><img/></a> here -->
            </div>
            <div class="meta" style="margin-top:8px">Climate-controlled shelving and boxed collections. Click an image to open full size.</div>
            <div style="margin-top:10px"><a class="btn" href="/donor/harc-archives-toolkit.html" target="_blank" rel="noopener">Open Toolkit</a></div>
          </div>
        </div>
      </div>

      <!-- aside / connect with us -->
      <aside class="connect" aria-labelledby="connect-heading">
        <h3 id="connect-heading">Connect with Us</h3>
        <p class="meta">Questions about transfers, tours, or assessments? Reach out — we're happy to help.</p>

        <!-- thumbnail with fallback -->
        <img class="thumb" src="/donor/vault-1.jpg" alt="HARC archival vault with shelving and boxes" onerror="this.style.display='none'">

        <div style="margin-top:8px">
          <a class="btn" href="tel:+15746786155">(574) 678-6155</a>
          <a class="btn" style="background:#2c7be5;margin-left:8px" href="mailto:japryse@harcsm.org">Email HARC</a>
        </div>

        <div style="margin-top:12px">
          <div class="small" style="font-weight:700;margin-bottom:6px">Visit / Resources</div>
          <a class="muted" href="/donor/storage-environment-chart.html" title="Archival Storage Environment Standards">Archival Storage Environment Standards</a><br>
          <a class="muted" href="/donor/harc-archives-toolkit.html" title="Open HARC Transition Toolkit">Open HARC Transition Toolkit</a>
        </div>

        <hr style="margin:12px 0;border:none;border-top:1px solid #e7eefb">

        <div>
          <h4 style="margin:0 0 6px 0">Office Hours</h4>
          <p class="small">Mon–Fri, 9:00am–4:00pm (by appointment)</p>
          <a class="btn" href="#request-visit" style="background:#0b57a4">Request Visit</a>
        </div>
      </aside>
    </div>
  </section>

  <main class="wrap" id="resources" role="main">
    <section class="card pdf-wrap preview-highlight" aria-labelledby="preview" role="region">
  <div class="preview-header">
    <h3 id="preview">Preview files <span class="preview-badge" aria-hidden="true">Preview</span></h3>
    <div class="preview-help">Click a file to preview — it will open here if available</div>
  </div>

  <!-- existing iframe & fallback (unchanged behavior) -->
  <iframe id="pdfViewer" class="pdf-frame" title="PDF preview" loading="lazy" aria-hidden="true"></iframe>

  <div id="pdfError" class="error-box" role="status" aria-live="polite">
    <strong>File not found</strong>
    <p class="meta" style="margin:6px 0 8px">The selected preview file couldn't be located. Use the Download button to open the file or browse the donor folder.</p>
    <p><a id="pdfDownloadFallback" class="btn" href="/donor/" target="_blank" rel="noopener">Open donor folder</a></p>
  </div>

  <!-- File lists in requested order -->
  <div style="margin-top:12px;display:grid;gap:10px">

    <div id="collection-agreement" class="file-row">
      <div>
        <div style="font-weight:600">1 — Collection Transfer Agreement (draft)</div>
        <div class="meta">Transfer terms, legal and practical notes for congregations.</div>
      </div>
      <div style="display:flex;gap:8px">
        <a class="btn" href="#" data-src="/donor/harc-donor-congregation-agreement-draft2.pdf" onclick="previewPDF(event)">Preview</a>
        <a class="btn" href="/donor/harc-donor-congregation-agreement-draft2.pdf" target="_blank" rel="noopener">Download</a>
      </div>
    </div>

    <div id="policies" class="file-row">
      <div>
        <div style="font-weight:600">2 — Collection Policy (draft)</div>
        <div class="meta">Overview of accessioning, access, and retention.</div>
      </div>
      <div style="display:flex;gap:8px">
        <a class="btn" href="#" data-src="/donor/harc-collection-policy-2025-draft1.pdf" onclick="previewPDF(event)">Preview</a>
        <a class="btn" href="/donor/harc-collection-policy-2025-draft1.pdf" target="_blank" rel="noopener">Download</a>
      </div>
    </div>

    <div id="publication-loan" class="file-row">
      <div>
        <div style="font-weight:600">3 — Publication Loan Agreement (draft)</div>
        <div class="meta">Terms for loaning items for publication.</div>
      </div>
      <div style="display:flex;gap:8px">
        <a class="btn" href="#" data-src="/donor/harc-publication-loan-agreement-draft1.pdf" onclick="previewPDF(event)">Preview</a>
        <a class="btn" href="/donor/harc-publication-loan-agreement-draft1.pdf" target="_blank" rel="noopener">Download</a>
      </div>
    </div>

    <div id="image-use" class="file-row">
      <div>
        <div style="font-weight:600">4 — Image Use Agreement (draft)</div>
        <div class="meta">Permissions and reproduction guidance.</div>
      </div>
      <div style="display:flex;gap:8px">
        <a class="btn" href="#" data-src="/donor/harc-image-use-agreement-draft1.pdf" onclick="previewPDF(event)">Preview</a>
        <a class="btn" href="/donor/harc-image-use-agreement-draft1.pdf" target="_blank" rel="noopener">Download</a>
      </div>
    </div>

    <div id="stacks" class="file-row">
      <div>
        <div style="font-weight:600">5 — Stacks / Reading Room Agreement (draft)</div>
        <div class="meta">Onsite use and handling guidance.</div>
      </div>
      <div style="display:flex;gap:8px">
        <a class="btn" href="#" data-src="/donor/harc-stacks-readingroom-agreement-draft1.pdf" onclick="previewPDF(event)">Preview</a>
        <a class="btn" href="/donor/harc-stacks-readingroom-agreement-draft1.pdf" target="_blank" rel="noopener">Download</a>
      </div>
    </div>

  </div>
</section>

    <section class="card" style="margin-top:16px">
      <h3>More Information</h3>
      <p class="meta">Click the top menu buttons for examples of box- and item-level inventories. </p>
    </section>
  </main>

  <footer>
    <div class="wrap">Made with care — Heritage &amp; Research Center at Saint Mary's · <a href="https://github.com/prys0000/prys0000.github.io" target="_blank" rel="noopener">GitHub</a></div>
  </footer>

  <script>
    // Create an inline SVG fallback element when images fail
    function createImageFallback() {
      var wrapper = document.createElement('div');
      wrapper.style.width = '100%';
      wrapper.style.height = '84px';
      wrapper.style.display = 'grid';
      wrapper.style.placeItems = 'center';
      wrapper.style.background = '#f8fafc';
      wrapper.style.borderRadius = '8px';
      wrapper.style.border = '1px solid rgba(15,23,42,0.04)';
      wrapper.innerHTML = '<svg width="56" height="56" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true"><rect width="24" height="24" rx="4" fill="#e6eefb"/><path d="M4 17l4-6 3 4 3-5 5 8" stroke="#9fb8e6" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>';
      return wrapper;
    }

    // Smooth scroll for internal hash links (preserve simple hash behavior)
    document.addEventListener('click', function(e){
      var a = e.target.closest('a');
      if(!a) return;
      var href = a.getAttribute('href') || '';
      if(href.startsWith('#')){
        var el = document.querySelector(href);
        if(el){ e.preventDefault(); el.scrollIntoView({behavior:'smooth',block:'start'}); }
      }
    });

    // Attempt HEAD check and then show iframe; show error fallback if not found.
    async function checkAndShowPdf(url){
      var iframe = document.getElementById('pdfViewer');
      var err = document.getElementById('pdfError');
      var downloadFallback = document.getElementById('pdfDownloadFallback');

      iframe.style.display = 'none';
      iframe.src = '';
      iframe.setAttribute('aria-hidden', 'true');
      err.style.display = 'none';
      downloadFallback.href = '/donor/';

      try {
        // HEAD requests can be blocked by some hosts — fall back to a simple GET if HEAD fails with CORS.
        let headOk = false;
        try {
          let headResp = await fetch(url, { method: 'HEAD' });
          headOk = headResp.ok;
        } catch (hx) {
          // HEAD failed (possible CORS). Try a lightweight fetch for the first bytes, but don't download large bodies.
          try {
            let resp = await fetch(url, { method: 'GET', headers: { Range: 'bytes=0-0' } });
            headOk = resp.ok;
          } catch (gx) {
            headOk = false;
          }
        }

        if (headOk) {
          iframe.src = url;
          iframe.style.display = 'block';
          iframe.setAttribute('aria-hidden', 'false');
          iframe.scrollIntoView({behavior:'smooth'});
          return true;
        } else {
          err.style.display = 'block';
          return false;
        }
      } catch (errFetch) {
        err.style.display = 'block';
        return false;
      }
    }

    function previewPDF(e){
      e.preventDefault();
      var src = e.currentTarget.getAttribute('data-src');
      if(!src) return;
      checkAndShowPdf(src);
    }

    // Combined preview + scroll for tiles
    function previewAndScroll(e){
      e.preventDefault();
      var a = e.currentTarget;
      var src = a.dataset.src;
      var href = a.getAttribute('href');

      if(src) checkAndShowPdf(src);
      if(href && href.startsWith('#')){
        var el = document.querySelector(href);
        if(el) el.scrollIntoView({ behavior: 'smooth', block: 'start' });
      } else if (href && href !== '#') {
        // if link points to an external page, open it
        window.open(href, '_blank', 'noopener');
      }
    }

    // Auto-preview: prefer toolkit tile if present; otherwise the first data-src found.
    document.addEventListener('DOMContentLoaded', function(){
      var toolkit = document.getElementById('toolkit-link');
      if(toolkit && toolkit.dataset && toolkit.dataset.src){
        checkAndShowPdf(toolkit.dataset.src);
        return;
      }
      var first = document.querySelector('[data-src]');
      if(first) checkAndShowPdf(first.getAttribute('data-src'));
    });
  </script>
</body>
</html>
