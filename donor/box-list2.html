<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>HARC — Box-level Inventory (Editable)</title>
  <meta name="description" content="Editable box-level inventory template for donors — one row per physical container — Heritage & Research Center at Saint Mary's." />
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Merriweather:wght@700&display=swap" rel="stylesheet">

  <style>
    :root{
      --bg:#f7f8fa;
      --card:#ffffff;
      --muted:#6b6f80;
      --accent:#1e3c72;
      --accent-2:#2a5298;
      --gold:#f4c84a;
      --radius:10px;
      --container:1200px;
    }

    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family:Inter,system-ui,Segoe UI,Roboto,Arial;
      background:var(--bg);
      color:var(--accent);
      line-height:1.45;
      padding:18px;
    }
    a{color:var(--accent-2);text-decoration:none}
    .muted{color:var(--muted)}
    .wrap{max-width:var(--container);margin:0 auto}

    header{
      background:rgba(255,255,255,0.7);
      backdrop-filter:blur(4px);
      border-bottom:1px solid rgba(15,23,42,0.06);
      position:sticky;
      top:0;
      z-index:10;
    }

    .nav{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      padding:12px 18px;
    }

    .brand{display:flex;gap:12px;align-items:center}
    .logo-link{display:inline-block;line-height:0}
    .logo-link:focus{outline:3px solid rgba(30,60,114,0.18);border-radius:8px}
    .logo-img{height:79px;width:auto;display:block;border-radius:0}

    .logo-fallback{
      width:79px;
      height:79px;
      border-radius:8px;
      background:linear-gradient(135deg,var(--accent-2),var(--accent));
      color:#fff;
      display:inline-grid;
      place-items:center;
      font-weight:700;
      font-family:Merriweather;
    }

    .button{
      background:var(--accent-2);
      color:#fff;
      padding:9px 14px;
      border-radius:8px;
      font-weight:600;
      border:0;
      cursor:pointer;
    }
    .button:hover{background:var(--accent)}

    .hero{padding:20px 0}
    .hero-grid{
      display:grid;
      grid-template-columns:1fr 320px;
      gap:16px;
      align-items:start;
    }
    @media (max-width:1100px){
      .hero-grid{grid-template-columns:1fr}
    }

    h1{
      font-family:Merriweather;
      font-size:22px;
      margin:0 0 8px;
      color:var(--accent);
    }
    h2{color:var(--accent)}
    .lead{color:var(--muted);margin:0 0 14px}

    .card{
      background:var(--card);
      border-radius:var(--radius);
      padding:14px;
      box-shadow:0 8px 24px rgba(30,60,114,0.08);
    }

    .info-grid{
      display:grid;
      grid-template-columns:repeat(2,1fr);
      gap:10px;
      margin-top:12px;
    }

    .info-field label{
      display:block;
      font-weight:600;
      color:var(--accent);
      margin-bottom:6px;
      font-size:0.9rem;
    }

    .info-field input{
      width:100%;
      padding:8px;
      border:1px solid #e6e6e6;
      border-radius:8px;
      font-size:0.95rem;
    }

    .note{
      background:#eef6ff;
      border-left:4px solid #b7d0ff;
      padding:12px;
      border-radius:8px;
      color:#0f172a;
      margin-top:12px;
      font-size:0.95rem;
    }

    .table-wrap{
      overflow:auto;
      margin-top:12px;
      border-radius:8px;
    }

    table{
      width:100%;
      border-collapse:collapse;
      min-width:980px;
    }

    thead th{
      position:sticky;
      top:0;
      background:linear-gradient(180deg,var(--accent-2),var(--accent));
      color:#fff;
      padding:12px 10px;
      text-align:left;
      font-weight:700;
      font-size:0.85rem;
    }

    tbody td{
      padding:10px;
      border:1px solid #eee;
      vertical-align:top;
      font-size:0.9rem;
      color:#222;
    }

    tbody tr:nth-child(even){background:#f8fbff}
    tbody tr.example-row{background:#e3efff}
    tbody tr:hover{background:#f1f6ff}

    .example-label{
      display:inline-block;
      background:var(--accent-2);
      color:#fff;
      padding:7px 12px;
      border-radius:6px;
      font-weight:600;
      margin:12px 0;
      font-size:0.9rem;
    }

    .controls{
      display:flex;
      gap:8px;
      flex-wrap:wrap;
      align-items:center;
      margin-bottom:10px;
    }

    .btn{
      display:inline-block;
      padding:8px 12px;
      border-radius:8px;
      background:var(--accent);
      color:#fff;
      text-decoration:none;
      font-weight:600;
      border:0;
      cursor:pointer;
    }
    .btn:hover{background:var(--accent-2)}

    .btn.ghost{
      background:transparent;
      color:var(--accent-2);
      border:1px solid rgba(30,60,114,0.18);
    }
    .btn.ghost:hover{
      background:rgba(30,60,114,0.05);
    }

    .btn.secondary{background:#6b7280}
    .btn.secondary:hover{background:#4b5563}
    .small{padding:6px 8px;font-size:0.9rem}

    .summary{
      display:grid;
      grid-template-columns:repeat(3,1fr);
      gap:12px;
      margin-top:14px;
    }

    .summary .item{
      background:#f2f6ff;
      padding:12px;
      border-radius:8px;
      text-align:center;
    }

    .summary .label{
      font-size:0.85rem;
      color:var(--muted);
    }

    .summary .value{
      font-weight:700;
      font-size:1.25rem;
      color:var(--accent);
      margin-top:6px;
    }

    .notes{
      margin-top:14px;
      background:#f8fbff;
      padding:12px;
      border-radius:8px;
      border:1px solid #e3efff;
    }

    .notes h3{
      margin:0 0 8px;
      color:var(--accent-2);
      font-size:1rem;
    }

    .notes p{
      margin:0;
      color:var(--muted);
      font-size:0.95rem;
    }

    footer.page{
      margin-top:18px;
      padding-top:12px;
      border-top:1px solid #eee;
      color:var(--muted);
      font-size:0.9rem;
      text-align:center;
    }

    @media print{
      body{padding:0}
      header .logo-img{display:none}
      .card{
        box-shadow:none;
        border-radius:0;
        padding:6mm;
      }
      thead th{
        background:var(--accent) !important;
        -webkit-print-color-adjust:exact;
      }
      .controls, .example-label, .notes, footer.page{display:none}
      tbody td{font-size:11px}
    }

    .sr-only{
      position:absolute !important;
      width:1px;
      height:1px;
      padding:0;
      margin:-1px;
      overflow:hidden;
      clip:rect(0,0,0,0);
      white-space:nowrap;
      border:0;
    }

    .brand-title{
      font-weight:700;
      font-family:Merriweather;
      font-size:18px;
      color:var(--accent);
    }

    .brand-sub{
      font-size:13px;
      color:var(--muted);
    }
  </style>
</head>
<body>
  <header>
    <div class="wrap nav" role="banner">
      <div class="brand">
        <a class="logo-link" href="/donor/#handling" aria-label="Back to HARC home">
          <img src="/donor/harc-logo-2.jpg" alt="Heritage & Research Center" class="logo-img"
               onerror="this.style.display='none'; document.getElementById('logoFallback').style.display='inline-grid';" />
          <div id="logoFallback" class="logo-fallback" style="display:none" aria-hidden="true">H</div>
        </a>

        <div>
          <div class="brand-title">Heritage & Research Center</div>
          <div class="brand-sub">Box-level Inventory Template</div>
        </div>
      </div>

      <nav>
        <a class="button" href="/donor/#handling">Home</a>
        <a class="button" href="/donor/item-level-inventory.html" target="_blank" rel="noopener">Item-level Inventory</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <section class="hero">
      <div class="hero-grid">
        <div>
          <div class="card">
            <h2 style="margin:0;font-family:Merriweather">Box-level Inventory</h2>
            <div class="lead muted">
              Record one row per physical container (box, volume, oversize folder). Capture box
              labels, date ranges, content summaries, and any handling or restriction notes.
              Edit cells directly and export as CSV.
            </div>

            <div class="info-grid" aria-label="collection information" style="margin-top:12px">
              <div class="info-field">
                <label>Collection / Donor</label>
                <input id="collectionName" type="text" placeholder="Collection name or donor">
              </div>
              <div class="info-field">
                <label>Date of inventory</label>
                <input id="inventoryDate" type="date">
              </div>
              <div class="info-field">
                <label>Prepared by</label>
                <input id="preparedBy" type="text" placeholder="Name and title">
              </div>
              <div class="info-field">
                <label>Contact</label>
                <input id="contactInfo" type="text" placeholder="Phone / Email">
              </div>
            </div>

            <div class="note" role="note">
              <strong>Instructions:</strong> Use one row per box or oversize container. Include the
              exact label written on the box, an approximate date range, and a brief summary of
              contents. Note any fragile, restricted, or oversize material in the <em>Notes / Flags</em>
              column. Please do not discard or re-folder items before HARC staff review.
            </div>
          </div>
        </div>

        <aside>
          <div class="card" role="complementary" aria-label="Upload & contact">
            <div style="font-weight:700;margin-bottom:8px;color:var(--accent)">Upload digital files</div>
            <div class="muted" style="margin-bottom:8px">
              Upload photos of boxes, scans of inventories, or spreadsheets to our OneDrive folder —
              please include Box # and donor name in filenames.
            </div>
            <a class="btn" id="oneDriveUploadBtn"
               href="https://harcsm-my.sharepoint.com/:f:/g/personal/japryse_harcsm_org/Eju8HJkt6AFHhHYgm--6KocBicuIOWP_uFHpF6XEO2wEkw?e=OfSHBa"
               target="_blank" rel="noopener">
              Upload to OneDrive
            </a>

            <hr style="border:none;border-top:1px solid rgba(15,23,42,0.04);margin:12px 0">

            <div style="margin-top:8px">
              <div style="font-weight:600;color:var(--accent)">Email</div>
              <div class="muted">
                <a href="mailto:bgordon@harcsm.org" style="color:var(--accent-2)">bgordon@harcsm.org</a>
              </div>
              <div style="font-weight:600;margin-top:10px;color:var(--accent)">Phone</div>
              <div class="muted">(574) 678-6155</div>
            </div>
          </div>
        </aside>
      </div>
    </section>

    <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;margin:8px 0">
      <div class="example-label">EXAMPLE ROWS — edit or delete</div>
      <div class="controls">
        <button class="btn" id="addRowBtn">+ Add row</button>
        <button class="btn ghost small" id="clearExamplesBtn">Clear examples</button>
        <button class="btn secondary small" id="printBtn">Print</button>
        <button class="btn" id="exportCsvBtn">Export CSV</button>
      </div>
    </div>

    <div id="table" class="table-wrap card" style="padding:12px">
      <table aria-labelledby="table-title">
        <thead>
          <tr>
            <th style="width:80px">Box</th>
            <th style="width:130px">Series / Subseries</th>
            <th style="width:140px">Container Type</th>
            <th style="width:220px">Label on Box</th>
            <th style="width:140px">Date Range</th>
            <th style="width:220px">Content Summary</th>
            <th style="width:110px">Extent / LF</th>
            <th style="width:130px">Location</th>
            <th style="width:200px">Notes / Flags</th>
            <th style="width:110px">Barcode / ID</th>
          </tr>
        </thead>
        <tbody id="tableBody">
          <!-- Example rows -->
          <tr class="example-row">
            <td contenteditable="true">1</td>
            <td contenteditable="true">Series 1</td>
            <td contenteditable="true">Records center box</td>
            <td contenteditable="true">General Correspondence, A–C</td>
            <td contenteditable="true">1950–1959</td>
            <td contenteditable="true">Letters between motherhouse and missions; administrative correspondence.</td>
            <td contenteditable="true">1.0 lf</td>
            <td contenteditable="true">Vault A, Bay 1, Shelf 2</td>
            <td contenteditable="true">Some rusted fasteners; handle with care.</td>
            <td contenteditable="true"></td>
          </tr>

          <tr class="example-row">
            <td contenteditable="true">OS-1</td>
            <td contenteditable="true">Photographs</td>
            <td contenteditable="true">Oversize flat box</td>
            <td contenteditable="true">Mounted photographs, missions</td>
            <td contenteditable="true">1930s–1940s</td>
            <td contenteditable="true">Oversize photographic prints of early mission houses and group portraits.</td>
            <td contenteditable="true">0.5 lf</td>
            <td contenteditable="true">Vault A, Flat 3</td>
            <td contenteditable="true">FRAGILE — do not stack on top.</td>
            <td contenteditable="true"></td>
          </tr>

          <tr class="example-row">
            <td contenteditable="true">AV-3</td>
            <td contenteditable="true">Audiovisual</td>
            <td contenteditable="true">AV carton</td>
            <td contenteditable="true">Audio cassettes — oral histories</td>
            <td contenteditable="true">1985–1995</td>
            <td contenteditable="true">Sisters' oral history interviews on ministry and community life.</td>
            <td contenteditable="true">0.4 lf</td>
            <td contenteditable="true">Vault B, AV Shelf 1</td>
            <td contenteditable="true">AV — discuss digitization priority with HARC staff.</td>
            <td contenteditable="true"></td>
          </tr>

          <!-- blank editable rows -->
          <tr>
            <td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>
            <td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>
            <td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>
            <td contenteditable="true"></td>
          </tr>
          <tr>
            <td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>
            <td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>
            <td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>
            <td contenteditable="true"></td>
          </tr>
          <tr>
            <td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>
            <td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>
            <td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>
            <td contenteditable="true"></td>
          </tr>
          <tr>
            <td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>
            <td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>
            <td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>
            <td contenteditable="true"></td>
          </tr>
          <tr>
            <td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>
            <td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>
            <td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td>
            <td contenteditable="true"></td>
          </tr>
        </tbody>
      </table>

      <div id="status" style="margin-top:12px;color:var(--muted);font-size:0.95rem"></div>

      <div class="summary" aria-hidden="false">
        <div class="item">
          <div class="label">Total boxes</div>
          <div class="value" id="totalBoxes">___</div>
        </div>
        <div class="item">
          <div class="label">Unique series</div>
          <div class="value" id="uniqueSeries">___</div>
        </div>
        <div class="item">
          <div class="label">Locations listed</div>
          <div class="value" id="locations">___</div>
        </div>
      </div>

      <div class="notes" style="margin-top:12px">
        <h3>Additional notes</h3>
        <p class="muted">
          Use the <strong>Notes / Flags</strong> column to call out fragile items, mixed media,
          restricted material, or boxes that should be prioritized for review or rehousing. Export
          CSV to share with HARC staff.
        </p>
      </div>

      <div style="margin-top:12px;font-size:0.9rem;color:var(--muted)">
        <strong style="color:var(--accent)">Column definitions:</strong>
        <ul style="margin:8px 0 0 18px">
          <li><strong>Box</strong> — physical container number or ID (e.g., "1", "OS-1", "AV-3").</li>
          <li><strong>Series / Subseries</strong> — series or grouping, if known.</li>
          <li><strong>Container Type</strong> — records center box, oversize flat, AV carton, volume, etc.</li>
          <li><strong>Label on Box</strong> — exact wording written on the box or folder.</li>
          <li><strong>Date Range</strong> — inclusive dates for predominant contents.</li>
          <li><strong>Content Summary</strong> — brief description of what’s inside.</li>
          <li><strong>Extent / LF</strong> — approximate linear feet or volume size.</li>
          <li><strong>Location</strong> — existing shelf, room, or vault location (if applicable).</li>
          <li><strong>Notes / Flags</strong> — fragile, restricted, AV, mold concerns, etc.</li>
          <li><strong>Barcode / ID</strong> — any barcode, call number, or internal ID used on site.</li>
        </ul>
      </div>
    </div>

    <footer class="page">
      <div class="muted">
        Heritage & Research Center at Saint Mary's · Email:
        <a href="mailto:bgordon@harcsm.org" style="color:var(--accent-2)">bgordon@harcsm.org</a> ·
        Location: Saint Mary's, South Bend, IN
      </div>
      <div style="margin-top:8px;color:var(--muted)">
        Submit completed inventory with your Deed of Gift / Transfer Agreement.
      </div>
    </footer>
  </main>

  <script>
    // Helpers
    function createCell(text = '') {
      const td = document.createElement('td');
      td.contentEditable = 'true';
      td.innerText = text;
      return td;
    }

    function addRow(values = []) {
      const tbody = document.getElementById('tableBody');
      const tr = document.createElement('tr');
      // 10 columns
      for (let i = 0; i < 10; i++) {
        tr.appendChild(createCell(values[i] || ''));
      }
      tbody.appendChild(tr);
      updateSummary();
      return tr;
    }

    document.getElementById('addRowBtn').addEventListener('click', () => {
      addRow();
      const tbody = document.getElementById('tableBody');
      tbody.lastElementChild.querySelector('td').focus();
    });

    document.getElementById('clearExamplesBtn').addEventListener('click', () => {
      const tbody = document.getElementById('tableBody');
      [...tbody.querySelectorAll('tr.example-row')].forEach(r => r.remove());
      updateSummary();
    });

    document.getElementById('printBtn').addEventListener('click', () => window.print());

    document.getElementById('exportCsvBtn').addEventListener('click', () => {
      const collection = document.getElementById('collectionName').value.trim();
      const date = document.getElementById('inventoryDate').value;
      const prepared = document.getElementById('preparedBy').value.trim();
      const contact = document.getElementById('contactInfo').value.trim();

      const rows = [];
      rows.push(['Collection', collection || '']);
      rows.push(['Inventory date', date || '']);
      rows.push(['Prepared by', prepared || '']);
      rows.push(['Contact', contact || '']);
      rows.push([]);

      const header = [
        'Box',
        'Series / Subseries',
        'Container Type',
        'Label on Box',
        'Date Range',
        'Content Summary',
        'Extent / LF',
        'Location',
        'Notes / Flags',
        'Barcode / ID'
      ];
      rows.push(header);

      const tbody = document.getElementById('tableBody');
      tbody.querySelectorAll('tr').forEach(tr => {
        const cells = [...tr.querySelectorAll('td')].map(td =>
          td.innerText.replace(/\r?\n|\r/g, ' ').trim()
        );
        if (cells.every(c => c === '')) return;
        rows.push(cells);
      });

      const csv = rows
        .map(r => r.map(cell => `"${(cell || '').replace(/"/g, '""')}"`).join(','))
        .join('\r\n');
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      const safe = (collection || 'box-inventory').replace(/\s+/g, '-').toLowerCase();
      a.download = `box-inventory-${safe}.csv`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
      document.getElementById('status').innerText = 'CSV exported.';
      setTimeout(() => (document.getElementById('status').innerText = ''), 2500);
    });

    function updateSummary() {
      const tbody = document.getElementById('tableBody');
      const rows = Array.from(tbody.querySelectorAll('tr'));
      const filled = rows.filter(r =>
        [...r.querySelectorAll('td')].some(td => td.innerText.trim() !== '')
      );
      document.getElementById('totalBoxes').innerText = filled.length || '___';

      const seriesSet = new Set();
      const locSet = new Set();

      filled.forEach(r => {
        const tds = r.querySelectorAll('td');
        const series = tds[1]?.innerText.trim();
        const loc = tds[7]?.innerText.trim();
        if (series) seriesSet.add(series);
        if (loc) locSet.add(loc);
      });

      document.getElementById('uniqueSeries').innerText =
        seriesSet.size ? seriesSet.size : '___';
      document.getElementById('locations').innerText =
        locSet.size ? Array.from(locSet).join(', ') : '___';
    }
    updateSummary();

    document.getElementById('tableBody').addEventListener('keydown', e => {
      if (e.key === 'Enter') {
        e.preventDefault();
        const tr = e.target.closest('tr');
        const next = tr.nextElementSibling;
        if (next) next.querySelector('td').focus();
        else addRow();
      }
      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 's') {
        e.preventDefault();
        document.getElementById('exportCsvBtn').click();
      }
    });

    document.getElementById('tableBody').addEventListener('dblclick', e => {
      const td = e.target.closest('td');
      if (td) td.focus();
    });

    window.addEventListener('load', () => {
      const first = document.querySelector('#tableBody td[contenteditable="true"]');
      if (first) first.focus();
      updateSummary();
    });

    document.getElementById('tableBody').addEventListener('input', () => updateSummary());

    // OneDrive upload helper: non-blocking reminder
    document.getElementById('oneDriveUploadBtn')?.addEventListener('click', function () {
      const note = document.getElementById('status');
      if (note)
        note.textContent =
          'Tip: include Box # and donor name in filenames so staff can match uploads to inventories.';
      setTimeout(() => {
        if (note) note.textContent = '';
      }, 10000);
    });
  </script>
</body>
</html>
