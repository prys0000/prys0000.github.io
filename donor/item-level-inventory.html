<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>HARC — Item-level Finding Aid Inventory (Editable)</title>
  <meta name="description" content="Editable item-level finding aid inventory template for donors — Heritage & Research Center at Saint Mary's" />
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600&family=Merriweather:wght@700&display=swap" rel="stylesheet">
  <style>
    :root{
      --bg:#f6f7f8; --card:#fff; --muted:#6b7280;
      --accent:#383716; --accent-2:#4a4829; --gold:#c07a2c;
      --radius:10px; --container:1200px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{margin:0;font-family:Inter,system-ui,Segoe UI,Roboto,Arial;background:var(--bg);color:var(--accent);line-height:1.45;padding:18px}
    a{color:var(--accent-2);text-decoration:none}
    .wrap{max-width:var(--container);margin:0 auto}
    header{background:rgba(255,255,255,0.7);backdrop-filter:blur(4px);border-bottom:1px solid rgba(15,23,42,0.04);position:sticky;top:0;z-index:10}
    .nav{display:flex;align-items:center;justify-content:space-between;gap:12px;padding:12px 18px}
    .brand{display:flex;gap:12px;align-items:center}
    .logo-link{display:inline-block;line-height:0}
    .logo-link:focus{outline:3px solid rgba(74,72,41,0.12);border-radius:8px}
    .logo-img{height:79px;width:auto;display:block;border-radius:8px}
    .logo-fallback{ width:79px;height:79px;border-radius:8px;background:linear-gradient(135deg,var(--accent-2),#c7b19d);color:#fff;display:inline-grid;place-items:center;font-weight:700;font-family:Merriweather }
    .button{background:var(--accent-2);color:#fff;padding:9px 14px;border-radius:8px;font-weight:600;border:0}

    .hero{padding:20px 0}
    .hero-grid{display:grid;grid-template-columns:1fr 320px;gap:16px;align-items:start}
    @media (max-width:1100px){ .hero-grid{grid-template-columns:1fr} }

    h1{font-family:Merriweather;font-size:22px;margin:0 0 8px}
    .lead{color:var(--muted);margin:0 0 14px}

    .card{background:var(--card);border-radius:var(--radius);padding:14px;box-shadow:0 8px 24px rgba(15,23,42,0.06)}
    .info-grid{display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-top:12px}
    .info-field label{display:block;font-weight:600;color:var(--gold);margin-bottom:6px;font-size:0.9rem}
    .info-field input{width:100%;padding:8px;border:1px solid #e6e6e6;border-radius:8px;font-size:0.95rem}
    .note{background:#fff8e6;border-left:4px solid #ffd16a;padding:12px;border-radius:8px;color:#4a4a4a;margin-top:12px;font-size:0.95rem}

    .table-wrap{overflow:auto;margin-top:12px;border-radius:8px}
    table{width:100%;border-collapse:collapse;min-width:1200px}
    thead th{position:sticky;top:0;background:linear-gradient(180deg,var(--accent-2),#3b3a2c);color:#fff;padding:12px 10px;text-align:left;font-weight:700;font-size:0.85rem}
    tbody td{padding:10px;border:1px solid #eee;vertical-align:top;font-size:0.9rem;color:#222}
    tbody tr:nth-child(even){background:#fbfdff}
    tbody tr.example-row{background:#efece2}
    tbody tr:hover{background:#f7f7f6}

    .example-label{display:inline-block;background:var(--accent-2);color:#fff;padding:7px 12px;border-radius:6px;font-weight:600;margin:12px 0;font-size:0.9rem}
    .controls{display:flex;gap:8px;flex-wrap:wrap;align-items:center;margin-bottom:10px}
    .btn{display:inline-block;padding:8px 12px;border-radius:8px;background:var(--accent);color:#fff;text-decoration:none;font-weight:600;border:0;cursor:pointer}
    .btn.ghost{background:transparent;color:var(--accent-2);border:1px solid rgba(43,111,179,0.06)}
    .btn.secondary{background:#6b7280}
    .small{padding:6px 8px;font-size:0.9rem}

    .summary{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-top:14px}
    .summary .item{background:#f6f5f2;padding:12px;border-radius:8px;text-align:center}
    .summary .label{font-size:0.85rem;color:var(--muted)}
    .summary .value{font-weight:700;font-size:1.25rem;color:var(--gold);margin-top:6px}

    .notes{margin-top:14px;background:#fbfdff;padding:12px;border-radius:8px;border:1px solid #eef6ff}
    .notes h3{margin:0 0 8px;color:var(--accent-2);font-size:1rem}
    .notes p{margin:0;color:var(--muted);font-size:0.95rem}

    footer.page{margin-top:18px;padding-top:12px;border-top:1px solid #eee;color:var(--muted);font-size:0.9rem;text-align:center}

    @media print{
      body{padding:0}
      header .logo-img{display:none}
      .card{box-shadow:none;border-radius:0;padding:6mm}
      thead th{background:#2f2b20 !important; -webkit-print-color-adjust:exact}
      .controls, .example-label, .notes, footer.page {display:none}
      tbody td{font-size:11px}
    }

    .sr-only { position: absolute !important; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0; }
  </style>
</head>
<body>
  <header>
    <div class="wrap nav" role="banner">
      <div class="brand">
        <a class="logo-link" href="/donor/#handling" aria-label="Back to HARC home">
          <img src="/donor/logo-harc.jpg" alt="Heritage & Research Center" class="logo-img"
               onerror="this.style.display='none'; document.getElementById('logoFallback').style.display='inline-grid';" />
          <div id="logoFallback" class="logo-fallback" style="display:none" aria-hidden="true">H</div>
        </a>

        <div>
          <div class="brand-title">Heritage & Research Center</div>
          <div class="brand-sub">Item-level Finding Aid Inventory — Saint Mary's</div>
        </div>
      </div>

      <nav>
        <a class="button" href="/donor/#handling">Home</a>
        <a class="button" href="/donor/box-list.html" target="_blank" rel="noopener">Box List Inventory</a>
      </nav>
    </div>
  </header>

  <main class="wrap">
    <section class="hero">
      <div class="wrap hero-grid">
        <div>
          <div class="card">
            <h2 style="margin:0;font-family:Merriweather">Item-level Inventory</h2>
            <div class="lead muted">Record one row per item — good for photographs, postcards, newsletters, and individual artifacts. Edit cells directly and export as CSV.</div>

            <div class="info-grid" aria-label="collection information" style="margin-top:12px">
              <div class="info-field">
                <label>Collection / Donor</label>
                <input id="collectionName" type="text" placeholder="Collection name or donor">
              </div>
              <div class="info-field">
                <label>Date of inventory</label>
                <input id="inventoryDate" type="date">
              </div>
              <div class="info-field">
                <label>Prepared by</label>
                <input id="preparedBy" type="text" placeholder="Name and title">
              </div>
              <div class="info-field">
                <label>Contact</label>
                <input id="contactInfo" type="text" placeholder="Phone / Email">
              </div>
            </div>

            <div class="note" role="note">
              <strong>Instructions:</strong> Click any cell to edit. Keep item-level detail concise (title, date, physical dims). Preserve original order; do not remove or discard material before HARC staff review.
            </div>
          </div>
        </div>

        <aside>
          <div class="card" role="complementary" aria-label="Upload & contact">
            <div style="font-weight:700;margin-bottom:8px">Upload digital files</div>
            <div class="muted" style="margin-bottom:8px">
              Upload photos, scans, or spreadsheets to our OneDrive folder — please include Item ID or Box # and donor name in filenames.
            </div>
            <a class="btn" id="oneDriveUploadBtn" href="https://harcsm-my.sharepoint.com/:f:/g/personal/japryse_harcsm_org/Eju8HJkt6AFHhHYgm--6KocBicuIOWP_uFHpF6XEO2wEkw?e=OfSHBa" target="_blank" rel="noopener">Upload to OneDrive</a>

            <hr style="border:none;border-top:1px solid rgba(15,23,42,0.04);margin:12px 0">

            <div style="margin-top:8px">
              <div style="font-weight:600">Email</div>
              <div class="meta"><a href="mailto:bgordon@harcsm.org">bgordon@harcsm.org</a></div>
              <div style="font-weight:600;margin-top:10px">Phone</div>
              <div class="meta">(574) 678-6155</div>
            </div>
          </div>
        </aside>
      </div>
    </section>

    <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;margin:8px 0">
      <div class="example-label">EXAMPLE ROWS — edit or delete</div>
      <div class="controls">
        <button class="btn" id="addRowBtn">+ Add row</button>
        <button class="btn ghost small" id="clearExamplesBtn">Clear examples</button>
        <button class="btn secondary small" id="printBtn">Print</button>
        <button class="btn" id="exportCsvBtn">Export CSV</button>
      </div>
    </div>

    <div id="table" class="table-wrap card" style="padding:12px">
      <table aria-labelledby="table-title">
        <thead>
          <tr>
            <th style="width:80px">Box</th>
            <th style="width:110px">Item ID</th>
            <th style="width:200px">Collection Title</th>
            <th style="width:220px">Title</th>
            <th style="width:120px">Date Range</th>
            <th style="width:160px">Subject</th>
            <th style="min-width:260px">Description</th>
            <th style="width:160px">Rights</th>
            <th style="width:110px">Type</th>
            <th style="width:160px">Coverage</th>
            <th style="width:140px">Physical Dimensions</th>
            <th style="width:100px">Language</th>
            <th style="width:160px">Publisher</th>
          </tr>
        </thead>
        <tbody id="tableBody">
          <tr class="example-row">
            <td contenteditable="true">1</td>
            <td contenteditable="true">1</td>
            <td contenteditable="true"></td>
            <td contenteditable="true">Father John Joseph Sigstein</td>
            <td contenteditable="true"></td>
            <td contenteditable="true">Father John Joseph Sigstein</td>
            <td contenteditable="true">Photograph of Father John Joseph Sigstein</td>
            <td contenteditable="true">Our Lady of Victory Missionary Sisters retain all rights.</td>
            <td contenteditable="true">still image</td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
            <td contenteditable="true"></td>
          </tr>

          <tr class="example-row">
            <td contenteditable="true">1</td>
            <td contenteditable="true">3</td>
            <td contenteditable="true">Victory Noll postcards</td>
            <td contenteditable="true">Victory Noll west view</td>
            <td contenteditable="true">1920s</td>
            <td contenteditable="true">Victory Noll; Our Lady of Victory Missionary Sisters; Society of Missionary Catechists</td>
            <td contenteditable="true">View of Victory Noll from the west, circa 1920s.</td>
            <td contenteditable="true">Our Lady of Victory Missionary Sisters retain all rights.</td>
            <td contenteditable="true">postcard / still image</td>
            <td contenteditable="true">Huntington, Indiana</td>
            <td contenteditable="true">3.25" x 5.75"</td>
            <td contenteditable="true">English</td>
            <td contenteditable="true"></td>
          </tr>

          <tr class="example-row">
            <td contenteditable="true">2</td>
            <td contenteditable="true">119</td>
            <td contenteditable="true">The Missionary Catechist</td>
            <td contenteditable="true">The Missionary Catechist, December, 1943</td>
            <td contenteditable="true">December, 1943</td>
            <td contenteditable="true"></td>
            <td contenteditable="true">Newsletter issue: Volume 20:1, December 1943.</td>
            <td contenteditable="true"></td>
            <td contenteditable="true">newsletter</td>
            <td contenteditable="true">Huntington, Indiana</td>
            <td contenteditable="true"></td>
            <td contenteditable="true">English</td>
            <td contenteditable="true">The Missionary Catechist Publishing Company</td>
          </tr>

          <!-- blank editable rows -->
          <tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr>
          <tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr>
          <tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr>
          <tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr>
          <tr><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td><td contenteditable="true"></td></tr>
        </tbody>
      </table>

      <div id="status" style="margin-top:12px;color:var(--muted);font-size:0.95rem"></div>

      <div class="summary" aria-hidden="false">
        <div class="item"><div class="label">Total items</div><div class="value" id="totalItems">___</div></div>
        <div class="item"><div class="label">Unique boxes</div><div class="value" id="uniqueBoxes">___</div></div>
        <div class="item"><div class="label">Languages present</div><div class="value" id="languages">___</div></div>
      </div>

      <div class="notes" style="margin-top:12px">
        <h3>Additional notes</h3>
        <p class="muted">Use Special Notes column for handling flags, fragile items, or digitization needs. Export CSV to share with HARC staff.</p>
      </div>

      <div style="margin-top:12px;font-size:0.9rem;color:var(--muted)">
        <strong>Column definitions:</strong>
        <ul style="margin:8px 0 0 18px">
          <li><strong>Box</strong> — physical container number (e.g., "1", "OS-1").</li>
          <li><strong>Item ID</strong> — unique identifier within the collection.</li>
          <li><strong>Collection Title</strong> — series or group name, if applicable.</li>
          <li><strong>Title</strong> — short descriptive title for the item.</li>
          <li><strong>Date Range</strong> — inclusive date (e.g., 1920s; 5/9/2013).</li>
          <li><strong>Subject</strong> — controlled terms or keywords.</li>
          <li><strong>Description</strong> — brief description of the item content.</li>
          <li><strong>Rights</strong> — copyright or usage notes.</li>
          <li><strong>Type</strong> — still image, postcard, newsletter, audio, etc.</li>
          <li><strong>Coverage</strong> — place or geographic coverage.</li>
          <li><strong>Physical Dimensions</strong> — sizes, run times, etc.</li>
          <li><strong>Language</strong> — language of item.</li>
          <li><strong>Publisher</strong> — publisher or creator, if relevant.</li>
        </ul>
      </div>
    </div>

    <footer class="page">
      <div class="muted">Heritage & Research Center at Saint Mary's · Email: <a href="mailto:bgordon@harcsm.org">bgordon@harcsm.org</a> · Location: Saint Mary's, South Bend, IN</div>
      <div style="margin-top:8px;color:var(--muted)">Submit completed inventory with your Deed of Gift / Transfer Agreement.</div>
    </footer>
  </main>

  <script>
    // Helpers
    function createCell(text = '') {
      const td = document.createElement('td');
      td.contentEditable = 'true';
      td.innerText = text;
      return td;
    }

    function addRow(values = []) {
      const tbody = document.getElementById('tableBody');
      const tr = document.createElement('tr');
      for (let i = 0; i < 13; i++) {
        tr.appendChild(createCell(values[i] || ''));
      }
      tbody.appendChild(tr);
      updateSummary();
      return tr;
    }

    document.getElementById('addRowBtn').addEventListener('click', () => {
      addRow();
      const tbody = document.getElementById('tableBody');
      tbody.lastElementChild.querySelector('td').focus();
    });

    document.getElementById('clearExamplesBtn').addEventListener('click', () => {
      const tbody = document.getElementById('tableBody');
      [...tbody.querySelectorAll('tr.example-row')].forEach(r => r.remove());
      updateSummary();
    });

    document.getElementById('printBtn').addEventListener('click', () => window.print());

    document.getElementById('exportCsvBtn').addEventListener('click', () => {
      const collection = document.getElementById('collectionName').value.trim();
      const date = document.getElementById('inventoryDate').value;
      const prepared = document.getElementById('preparedBy').value.trim();
      const contact = document.getElementById('contactInfo').value.trim();

      const rows = [];
      rows.push(['Collection', collection || '']);
      rows.push(['Inventory date', date || '']);
      rows.push(['Prepared by', prepared || '']);
      rows.push(['Contact', contact || '']);
      rows.push([]);

      const header = ['Box','Item ID','Collection Title','Title','Date Range','Subject','Description','Rights','Type','Coverage','Physical Dimensions','Language','Publisher'];
      rows.push(header);

      const tbody = document.getElementById('tableBody');
      tbody.querySelectorAll('tr').forEach(tr => {
        const cells = [...tr.querySelectorAll('td')].map(td => td.innerText.replace(/\r?\n|\r/g, ' ').trim());
        if (cells.every(c => c === '')) return;
        rows.push(cells);
      });

      const csv = rows.map(r => r.map(cell => `"${(cell||'').replace(/"/g,'""')}"`).join(',')).join('\r\n');
      const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      const safe = (collection || 'item-inventory').replace(/\s+/g,'-').toLowerCase();
      a.download = `item-inventory-${safe}.csv`;
      document.body.appendChild(a);
      a.click();
      a.remove();
      URL.revokeObjectURL(url);
      document.getElementById('status').innerText = 'CSV exported.';
      setTimeout(()=> document.getElementById('status').innerText = '', 2500);
    });

    function updateSummary(){
      const tbody = document.getElementById('tableBody');
      const rows = Array.from(tbody.querySelectorAll('tr'));
      const filled = rows.filter(r => [...r.querySelectorAll('td')].some(td=>td.innerText.trim() !== ''));
      document.getElementById('totalItems').innerText = filled.length || '___';

      const boxes = new Set();
      filled.forEach(r => {
        const b = r.querySelector('td').innerText.trim();
        if(b) boxes.add(b);
      });
      document.getElementById('uniqueBoxes').innerText = boxes.size || '___';

      const langs = new Set();
      filled.forEach(r => {
        const l = r.querySelectorAll('td')[11].innerText.trim();
        if(l) langs.add(l);
      });
      document.getElementById('languages').innerText = (langs.size ? [...langs].join(', ') : '___');
    }
    updateSummary();

    document.getElementById('tableBody').addEventListener('keydown', (e) => {
      if (e.key === 'Enter') {
        e.preventDefault();
        const tr = e.target.closest('tr');
        const next = tr.nextElementSibling;
        if (next) next.querySelector('td').focus();
        else addRow();
      }
      if ((e.ctrlKey || e.metaKey) && e.key.toLowerCase() === 's') {
        e.preventDefault();
        document.getElementById('exportCsvBtn').click();
      }
    });

    document.getElementById('tableBody').addEventListener('dblclick', (e) => {
      const td = e.target.closest('td');
      if (td) td.focus();
    });

    window.addEventListener('load', ()=> {
      const first = document.querySelector('#tableBody td[contenteditable="true"]');
      if(first) first.focus();
    });

    document.getElementById('tableBody').addEventListener('input', ()=> updateSummary());

    // OneDrive upload helper: non-blocking reminder
    document.getElementById('oneDriveUploadBtn')?.addEventListener('click', function(){
      const note = document.getElementById('status');
      if(note) note.textContent = 'Tip: include Item ID or Box # and donor name in filenames so staff can match uploads to inventories.';
      setTimeout(()=> { if(note) note.textContent = ''; }, 10000);
    });
  </script>
</body>
</html>
